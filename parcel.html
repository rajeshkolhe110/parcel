<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Parcel Letter Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Verdana, sans-serif;
      background: #eef2f5;
      padding: 40px 10px;
    }

    .container {
      max-width: 900px;
      margin: auto;
      background: #fff;
      padding: 30px 40px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      margin-bottom: 30px;
      color: #333;
    }

    label {
      font-weight: 600;
      margin: 10px 0 5px;
      display: block;
      color: #333;
    }

    textarea, select {
      width: 100%;
      padding: 10px 14px;
      font-family: inherit;
      font-size: 14px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      resize: vertical;
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 15px;
    }

    .form-group {
      flex: 1 1 48%;
      min-width: 200px;
    }

    .btn-row {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    button {
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .print-btn {
      background-color: #28a745;
      color: #fff;
    }

    .print-btn:hover {
      background-color: #218838;
    }

    .download-btn {
      background-color: #0078D4;
      color: #fff;
    }

    .download-btn:hover {
      background-color: #005a9e;
    }

    #previewArea {
      margin-top: 40px;
      padding: 30px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: #fff;
      font-family: Verdana, sans-serif;
    }

    @media (max-width: 600px) {
      .form-row {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <h2>Parcel Letter Generator</h2>

  <label for="toInput">To:</label>
  <textarea id="toInput" rows="4">Pos Electronics,</textarea>

  <label for="fromInput">From:</label>
  <textarea id="fromInput" rows="4">AutoMekz Electronics,
Flat 2,Ram Height,Mahale Farm Cidco,Nashik
Pincode: 422009
Contact: 9503298303</textarea>

  <div class="form-row">
    <div class="form-group">
      <label for="fontSelect">Font</label>
      <select id="fontSelect">
        <option value="Verdana" selected>Verdana</option>
        <option value="Arial">Arial</option>
        <option value="Times New Roman">Times New Roman</option>
        <option value="Courier New">Courier New</option>
      </select>
    </div>

    <div class="form-group">
      <label for="fontSizeSelect">Font Size</label>
      <select id="fontSizeSelect">
        <option value="12pt">12 pt</option>
        <option value="14pt" selected>14 pt</option>
        <option value="16pt">16 pt</option>
        <option value="18pt">18 pt</option>
      </select>
    </div>

    <div class="form-group">
      <label for="lineSpacingSelect">Line Spacing</label>
      <select id="lineSpacingSelect">
        <option value="1">1</option>
        <option value="1.2" selected>1.2</option>
        <option value="1.5">1.5</option>
        <option value="2">2</option>
      </select>
    </div>

    <div class="form-group">
      <label for="charSpacingSelect">Character Spacing</label>
      <select id="charSpacingSelect">
        <option value="0px" selected>Normal</option>
        <option value="1px">1px</option>
        <option value="2px">2px</option>
        <option value="3px">3px</option>
      </select>
    </div>
  </div>

  <div class="btn-row">
    <button class="print-btn" onclick="printPreview()">Print</button>
    <button class="download-btn" onclick="downloadPDF()">Download PDF</button>
  </div>

  <div id="previewArea"></div>
</div>

<script>
  function getFormattedContent() {
    const toText = document.getElementById("toInput").value.trim();
    const fromText = document.getElementById("fromInput").value.trim();
    const font = document.getElementById("fontSelect").value;
    const fontSize = document.getElementById("fontSizeSelect").value;
    const lineSpacing = document.getElementById("lineSpacingSelect").value;
    const charSpacing = document.getElementById("charSpacingSelect").value;

    return `
      <div style="
        font-family: ${font};
        font-size: ${fontSize};
        line-height: ${lineSpacing};
        letter-spacing: ${charSpacing};
        white-space: pre-line;
      ">
        <strong>To:</strong><br>${toText}<br><br>
        <strong>From:</strong><br>${fromText}
      </div>
    `;
  }

  function updatePreview() {
    document.getElementById("previewArea").innerHTML = getFormattedContent();
  }

  function printPreview() {
    updatePreview();
    const printWindow = window.open('', '', 'width=800,height=600');
    printWindow.document.write('<html><head><title>Print</title></head><body>');
    printWindow.document.write(getFormattedContent());
    printWindow.document.write('</body></html>');
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
  }

  function downloadPDF() {
    updatePreview();
    const toText = document.getElementById("toInput").value.trim();
    const fileName = `Parcel_${toText.split("\n")[0].trim()}.pdf`;

    const opt = {
      margin: 0,
      filename: fileName,
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };

    html2pdf().set(opt).from(document.getElementById("previewArea")).save();
  }

  ["toInput", "fromInput", "fontSelect", "fontSizeSelect", "lineSpacingSelect", "charSpacingSelect"].forEach(id => {
    document.getElementById(id).addEventListener("input", updatePreview);
    document.getElementById(id).addEventListener("change", updatePreview);
  });

  window.onload = updatePreview;
</script>

</body>
</html>
